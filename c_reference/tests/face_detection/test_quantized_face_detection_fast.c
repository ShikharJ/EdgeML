// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license.

#include <stdio.h>
#include <time.h>
#include <stdlib.h>
#include <string.h>
#include <math.h>

#include "quantized_datatypes.h"
#include "quantized_face_detection_fast.h"

#define MEM_BUF_SIZE 165840
#define INPUT_IMG_HEIGHT 240
#define INPUT_IMG_WIDTH 320
#define OUTPUT_SIZE 5400

// Fixed Point Output Corresponding To Face-3 Image: 1
const Q15_T expected[OUTPUT_SIZE] = {4020, -9689, 4443, -11350, 5756, -12593, 5961, -12841, 6382, -13247, 5979, -12917, 4946, -13059, 6628, -12010, 8600, -11375, 8410, -11093, 8891, -11965, 6050, -9524, 5034, -8244, 3620, -5934, 4483, -8244, 4706, -9307, 4466, -9746, 4899, -10853, 4517, -10881, 5752, -10430, 5257, -13698, 8347, -18779, 10502, -18691, 11205, -18630, 10634, -17975, 9249, -17169, 6867, -17612, 6214, -14870, 4534, -8863, 3678, -7577, 4561, -9786, 6966, -14743, 5345, -10405, 5684, -12299, 5491, -13299, 5674, -9228, 7115, -14256, 6072, -10638, 6471, -15607, 7165, -11193, 4636, -14048, 6441, -19536, 6906, -19645, 7694, -19364, 6864, -18288, 6631, -16084, 6454, -16014, 7412, -14134, 5883, -10670, 3684, -9295, 4409, -9599, 9276, -15992, 4438, -8363, 6673, -12667, 6623, -5107, 5327, -11584, 4558, -8984, 5783, -11829, 5186, -9770, 5337, -8740, 4812, -13614, 5838, -16263, 6346, -16709, 7734, -16980, 6740, -15894, 6672, -16540, 5263, -14862, 4777, -12027, 4277, -9322, 5252, -12876, 5757, -10926, 5572, -14466, 4505, -11000, 5555, -13609, 6271, -9768, 5376, -13910, 7505, -9762, 6162, -13018, 5295, -14051, 5033, -12274, 3904, -9311, 6412, -12536, 6346, -14336, 8229, -14485, 4093, -7230, 5789, -16274, 4855, -15930, 4850, -10601, 3489, -11307, 5403, -15427, 5974, -13787, 3642, -11462, 2957, -7153, 6040, -16199, 4526, -8281, 4829, -11516, 6379, -15013, 4776, -10958, 5941, -14246, 5697, -15098, 3259, -8538, 4203, -14007, 5698, -15929, 6543, -14399, 5748, -9836, 4492, -13892, 5912, -13866, 4200, -11890, 4989, -10392, 4955, -10593, 5828, -7354, 4371, -10057, 6077, -16413, 5343, -14354, 4100, -6633, 3770, -11832, 6191, -14178, 5793, -14771, 5130, -15209, 4155, -13294, 6311, -12231, 7326, -17055, 6900, -9603, 4524, -4784, 4949, -9789, 5638, -11040, 4983, -7456, 3744, -5879, 1430, -5240, 4152, -7930, 2102, -4136, 5407, -7003, 5145, -12917, 3927, -8356, 3786, -6364, 6444, -9300, 6549, -13598, 5105, -11411, 4410, -3900, 4387, -6231, 4914, -11093, 5728, -12535, 2508, -7916, 3305, -10702, 3709, -10166, 6190, -14181, 5200, -7670, 5211, -7607, 5384, -9955, 3333, -8609, 4267, -10425, 3621, -11044, 4977, -8779, 6002, -10313, 5223, -4199, 6169, -11019, 5749, -5050, 3456, -4835, 2640, -7193, 1256, -2668, 5536, -9117, 6267, -9370, 3304, -4920, 3181, -6959, 4086, -6421, 5469, -11187, 7592, -13977, 6011, -8184, 4747, -6369, 4979, -9647, 3718, -8225, 6120, -10855, 3619, -9379, 7431, -15621, 3560, -3916, 3997, -10820, 3283, -5508, 4314, -5405, 2737, -7062, 3444, -8353, 4848, -8906, 5233, -12904, 4358, -10562, 3004, -5541, 3681, -5426, 6792, -10861, 6529, -10942, 5440, -7623, 5595, -11446, 6373, -13205, 6620, -15899, 7616, -14365, 6907, -11085, 7192, -10211, 6290, -9139, 7533, -14519, 3795, -5853, 4900, -9323, 5934, -9977, 5240, -13762, 5009, -8820, 6765, -10103, 6068, -10916, 4847, -10398, 5282, -10263, 4258, -10693, 5428, -12114, 5642, -12216, 4214, -9875, 5634, -12629, 6673, -14546, 6901, -12830, 5604, -7846, 5507, -12025, 5199, -7458, 5936, -8943, 6957, -12032, 6656, -13900, 7764, -12508, 5969, -11725, 4859, -6388, 4080, -6171, 7474, -9049, 5526, -9289, 6619, -15235, 7655, -14017, 7918, -13698, 6494, -15300, 6369, -10878, 4504, -10597, 6304, -7193, 6289, -8053, 5900, -8389, 5225, -7865, 5243, -10226, 6278, -8903, 6915, -14940, 7695, -13893, 5309, -12037, 3881, -8116, 4440, -9156, 4234, -8728, 5221, -7946, 8058, -9521, 8682, -15374, 9809, -14468, 7449, -13234, 8827, -13024, 7107, -11748, 5122, -6351, 5843, -7752, 6575, -14881, 6652, -12657, 7668, -12809, 8892, -14968, 6910, -13339, 7929, -10200, 7201, -13477, 7515, -9748, 4850, -6516, 6361, -10377, 9119, -10301, 8325, -13608, 11541, -14598, 10151, -13674, 12434, -15723, 10746, -13138, 12047, -12252, 9828, -10511, 8680, -15448, 8435, -11354, 7838, -9716, 9218, -11890, 9002, -12498, 9525, -14527, 12119, -16638, 10136, -13488, 9038, -12349, 6659, -7381, 4986, -9545, 6001, -10032, 7624, -12482, 7426, -12949, 9070, -14825, 8722, -12326, 9709, -14359, 9466, -12955, 9457, -14242, 8319, -12413, 7662, -12896, 7156, -11044, 6811, -9414, 8284, -12376, 9078, -12393, 9179, -13165, 8308, -13330, 8229, -10374, 7514, -11364, 5779, -9356, 4236, -6862, 9334, -8442, 11141, -10554, 12647, -11715, 13130, -12574, 13276, -12585, 11828, -11200, 11489, -11029, 11232, -11105, 11135, -10757, 10577, -10592, 10516, -10025, 9442, -9265, 8697, -8108, 7234, -6853, 9368, -8805, 10204, -9321, 10363, -9682, 10299, -9740, 9079, -8860, 7704, -7094, 11559, -10570, 13662, -12686, 12579, -11495, 12487, -11762, 12541, -11818, 12303, -11386, 12783, -12020, 12146, -11618, 9269, -8983, 7420, -7117, 8475, -8287, 10833, -10448, 10349, -9606, 8273, -7817, 8203, -7247, 9366, -8710, 8816, -7756, 10986, -10235, 12004, -11151, 9088, -8685, 11222, -10496, 13483, -12680, 12321, -11641, 12462, -11811, 13038, -11961, 11461, -10679, 11365, -10898, 10388, -10008, 10171, -9511, 7609, -7335, 7953, -7390, 10189, -9509, 7557, -6706, 9655, -9137, 6881, -6156, 8674, -7784, 7408, -6789, 9335, -8764, 10128, -9339, 9106, -8589, 10116, -8877, 11892, -11006, 11103, -10060, 10167, -9498, 9133, -8200, 9581, -9162, 11224, -10542, 9510, -8801, 10388, -9840, 9329, -9052, 9312, -8222, 8951, -8045, 7968, -7593, 9673, -9170, 9158, -8717, 10208, -9289, 7851, -7110, 9918, -9165, 11542, -11032, 9828, -9251, 8381, -7377, 8807, -8401, 9659, -9111, 6031, -5051, 4443, -3740, 10045, -9597, 10263, -9516, 7771, -7359, 7856, -6898, 10079, -9966, 10405, -9782, 7711, -6800, 7951, -7976, 10889, -9857, 9118, -8120, 10297, -9560, 9879, -9120, 10630, -9821, 11850, -11206, 11394, -10761, 6051, -5282, 8228, -7910, 9944, -9210, 7250, -6512, 6149, -5865, 8432, -7930, 8546, -8411, 8043, -7455, 6750, -6234, 7764, -7649, 7383, -6193, 7252, -7076, 9395, -9015, 10298, -9030, 7956, -7064, 9559, -9071, 11890, -10859, 11576, -10943, 11510, -11335, 11786, -11423, 7852, -7513, 9628, -9377, 8352, -7903, 5919, -5299, 7835, -7263, 8589, -7642, 4850, -4574, 4885, -4884, 6428, -6183, 8113, -7821, 7086, -6084, 6940, -6869, 10712, -10119, 8989, -8248, 8332, -7360, 9100, -8932, 9443, -9301, 8593, -7663, 5873, -5449, 5795, -5116, 7863, -7246, 9303, -8678, 8274, -7541, 8671, -8268, 8176, -7854, 8195, -7399, 4709, -4405, 5259, -5049, 6541, -6301, 7694, -7802, 7775, -7246, 8024, -7674, 6875, -6140, 8649, -7783, 6579, -5555, 7777, -7770, 4235, -3340, 4647, -4015, 5653, -5139, 4330, -3964, 8831, -8447, 6288, -5706, 7135, -6307, 6871, -6042, 8261, -7672, 10073, -9472, 9341, -8730, 4506, -4196, 2486, -2463, 5921, -5467, 6462, -5971, 9484, -8902, 7520, -6768, 8783, -8203, 4359, -3300, 5511, -5055, 3707, -2462, 2394, -1596, 6030, -4977, 7389, -6647, 9025, -8625, 7771, -7198, 7288, -6479, 5970, -5720, 6649, -6318, 8695, -7483, 8359, -7468, 6398, -5951, 4942, -4026, 8544, -7912, 9622, -9400, 9029, -8070, 7303, -6332, 7549, -7255, 7883, -6724, 8001, -7492, 5555, -4516, 2806, -2543, 7074, -5914, 9948, -8914, 7258, -6698, 6426, -5595, 7005, -6551, 7782, -7048, 8885, -7985, 8615, -7303, 9486, -8395, 8400, -7664, 6922, -5922, 8647, -8189, 9946, -9192, 8640, -8199, 7344, -6489, 9566, -8914, 7320, -6035, 8195, -7700, 8850, -7896, 9169, -8959, 9859, -8777, 9892, -8834, 5394, -5220, 4971, -4666, 5827, -5270, 7752, -7764, 11311, -10405, 10525, -9581, 10409, -9843, 10373, -9620, 8653, -7648, 9210, -8420, 6978, -6101, 6474, -6609, 7419, -6645, 9230, -8596, 7128, -6118, 7390, -6700, 10064, -8953, 10243, -9780, 10475, -9540, 8050, -7172, 7154, -6775, 7560, -7245, 5157, -4468, 8356, -8127, 11706, -10514, 11393, -10979, 11045, -10446, 11269, -10233, 9725, -9138, 8934, -8304, 9128, -7891, 9935, -9359, 9767, -8656, 9403, -8825, 9882, -8956, 10284, -9701, 9510, -8697, 9916, -9574, 6739, -6127, 6015, -5404, 10689, -9957, 10405, -10224, 8829, -7921, 9491, -9202, 11386, -10047, 10437, -9977, 11311, -10954, 8676, -8047, 9193, -8832, 11131, -10359, 10144, -9318, 10850, -10357, 10884, -10068, 10548, -10290, 10816, -9856, 11682, -10818, 11369, -10663, 9072, -8471, 7171, -6817, 8758, -7919, 10220, -9971, 11978, -12112, 11950, -11771, 11900, -12055, 12492, -12351, 11407, -11384, 11526, -11974, 7738, -7555, 8294, -8496, 12046, -11683, 12341, -12195, 11156, -11422, 10914, -10885, 12034, -12361, 12388, -12218, 11944, -12012, 11550, -11229, 11379, -11204, 10579, -10695, 9385, -9148, 10232, -10448, 10691, -11052, 10073, -10541, 10924, -11383, 11643, -11892, 11084, -11321, 11181, -11367, 11136, -11694, 12260, -12666, 11363, -11760, 10719, -11306, 10559, -11096, 9936, -9991, 9318, -9706, 9805, -10040, 9718, -10201, 10193, -10382, 10773, -11188, 10019, -10407, 9561, -9670, 12566, -12458, 12843, -12473, 11100, -10858, 11734, -11582, 12676, -12336, 10846, -10707, 10628, -10577, 12555, -12111, 11548, -11684, 10729, -10822, 11107, -11309, 11228, -11178, 9898, -9951, 10551, -10518, 11228, -11143, 11000, -10913, 10666, -10505, 11967, -12291, 11665, -11508, 10988, -10872, 12253, -12004, 12638, -12188, 11149, -10878, 10343, -10315, 11390, -11127, 10315, -10237, 11611, -11828, 11620, -11120, 10114, -10053, 9615, -9472, 9807, -9563, 10402, -10069, 9313, -9225, 10867, -10492, 11890, -11507, 11554, -11709, 11429, -11015, 12419, -12047, 12381, -11909, 12023, -11661, 12305, -12093, 12041, -11761, 11182, -11006, 10076, -10087, 8920, -8913, 9633, -9627, 11768, -11807, 11365, -11317, 9768, -9884, 9007, -9097, 9788, -9093, 9087, -8923, 9550, -9140, 10986, -10749, 12279, -11443, 11480, -11278, 9959, -9273, 10780, -10377, 11686, -11291, 11621, -11163, 10016, -10011, 9816, -10044, 9447, -9535, 7980, -7673, 6834, -6818, 8590, -8716, 11194, -10883, 9860, -9900, 7820, -7986, 8374, -8439, 8295, -7856, 8712, -8553, 8824, -8710, 10630, -10138, 10917, -10662, 10665, -10422, 9094, -8847, 9414, -8696, 10469, -10106, 10975, -10793, 9283, -9450, 8996, -8696, 8744, -8278, 8302, -8291, 8021, -8086, 9026, -9506, 11153, -10888, 9992, -9636, 7950, -7990, 7236, -7178, 7578, -7545, 7803, -7913, 8753, -8784, 10335, -9575, 9227, -9299, 8607, -8643, 8601, -8550, 8774, -9139, 9949, -10100, 11209, -11177, 9692, -9732, 9824, -9630, 9172, -8698, 7938, -7875, 8433, -8657, 10246, -10401, 8138, -8022, 7938, -8228, 7797, -8398, 7899, -7625, 7393, -7232, 8307, -8432, 9022, -9148, 8628, -8887, 7921, -8071, 7128, -7652, 8110, -8118, 8753, -8991, 9174, -9448, 8901, -9009, 9165, -9269, 10222, -10279, 7595, -7652, 6822, -6428, 7510, -7672, 9032, -8747, 7012, -7381, 6916, -7171, 6209, -6250, 7055, -7636, 6433, -6479, 7586, -7478, 8440, -8510, 8421, -8528, 5251, -5567, 5419, -5935, 5867, -6730, 7194, -7566, 8793, -9135, 9491, -9452, 9110, -9110, 8535, -8292, 7545, -7626, 6992, -6946, 6945, -7215, 8875, -9218, 8055, -8062, 5171, -5178, 3779, -3787, 6293, -6329, 6883, -6960, 7815, -7801, 8440, -8309, 8291, -7919, 4609, -4473, 5016, -5195, 5415, -5625, 4740, -4720, 6068, -6418, 9147, -9466, 8678, -8641, 8461, -8645, 8498, -8355, 8350, -8396, 7639, -7580, 8771, -8590, 9913, -9477, 8347, -8245, 6905, -6366, 7217, -7481, 7902, -7921, 8185, -7738, 7390, -7395, 8029, -7820, 6394, -6242, 6620, -6477, 5241, -5114, 2926, -2497, 5003, -5000, 8367, -8203, 8165, -8183, 7311, -7663, 8027, -8444, 7924, -8099, 9528, -9396, 9400, -9148, 10176, -9706, 9510, -9484, 8269, -7861, 8490, -8552, 8024, -7957, 8558, -8355, 8252, -8754, 8071, -7609, 7569, -7179, 8792, -8384, 9019, -8820, 6630, -6331, 8049, -7595, 8736, -8685, 7859, -7806, 8245, -8355, 8941, -8936, 8955, -9067, 10393, -10602, 10384, -10663, 10266, -10209, 10709, -10619, 9776, -9837, 10062, -9906, 8861, -8884, 9781, -9136, 9772, -9717, 9294, -9101, 8629, -8330, 9752, -9504, 9382, -9293, 7620, -7570, 7766, -7456, 8913, -9021, 8855, -8849, 9155, -8635, 9210, -8978, 9316, -9073, 10392, -10531, 11474, -11424, 9615, -9848, 10287, -10182, 10284, -10602, 11962, -11292, 9560, -9407, 9748, -9529, 10908, -10775, 11026, -10901, 11103, -10762, 10447, -10267, 10026, -9914, 8972, -8914, 8337, -8281, 9260, -9211, 11652, -11345, 11651, -10936, 8661, -8078, 9537, -8624, 10488, -10017, 11238, -10977, 10552, -9863, 10166, -9687, 11522, -11151, 12869, -12539, 11270, -10690, 10574, -10247, 11950, -11679, 11299, -11036, 11122, -10545, 10822, -10480, 10486, -9980, 10376, -9829, 10561, -10160, 11269, -10799, 10257, -10263, 11354, -11085, 8707, -8512, 9031, -8842, 9698, -9359, 9599, -9138, 9133, -8701, 8757, -8589, 9466, -9140, 10608, -10250, 10496, -10246, 10542, -10217, 10590, -10206, 10062, -9866, 10729, -10354, 10719, -10405, 10027, -9612, 9676, -9360, 10070, -9585, 10206, -9798, 1784, -549, -8135, -4667, 1817, 5255, -7697, -6475, 2681, 7244, -8933, -7746, 2848, 7752, -10341, -8904, 2479, 7680, -9678, -8626, 3419, 7380, -8503, -7546, 2786, 6896, -7399, -6240, 2846, 7347, -8019, -6015, 4366, 8472, -7973, -5826, 310, 7564, -7825, -5513, 491, 4548, -7403, -4878, -207, 7593, -4432, -2059, 5296, 10414, -4127, -2539, 3208, 12108, -2553, -561, 599, 6177, -5473, -4148, 3459, 8951, -7175, -5962, 4213, 7881, -8558, -6717, 911, 6764, -4980, -3965, -1367, 6349, -4850, -3237, 422, 8468, -8004, -4534, 2634, 424, -7110, -2775, -143, -1147, -3669, -1821, 2995, 1643, -1916, 924, 2958, 377, -3160, 282, 3749, 713, -2399, 715, 3474, 121, -1940, 755, 2297, -150, -4876, -2529, 1511, -774, -5204, -2124, 15950, 6578, -6016, -3089, 2911, 11457, -9813, -7634, 2190, 9993, -9426, -7450, -8815, 4632, -6865, -3992, -4015, 94, -5696, -3357, 5785, -9394, -5125, -1994, 1651, 4315, -6206, -4402, -1358, -3105, -5889, -4222, -3678, -619, -6298, -4098, -5862, -1296, -3711, -1651, -842, 673, -6256, -3735, -1523, -3387, -9288, -3833, 2333, 2548, -6493, -2514, -4025, 2393, -3013, -1342, -780, 3412, -298, 1843, -1919, 1894, -1115, 1820, 894, 1880, -2982, 155, 152, 2897, -1488, 1161, 398, 2463, -2996, -454, 4289, 1656, -1596, 1859, 11764, -4507, -4864, -861, -234, -7349, -5571, -3277, -2490, -6695, -4892, -2155, 4983, -4588, -6839, -3374, -8776, -6638, -4404, -1189, 2189, -3941, -5373, -2636, 1877, -2111, -1259, 860, -5985, -1998, -4317, -2278, -7795, -5328, -3469, -942, -6345, -3270, -4076, -1447, -4684, -5248, -8729, -6080, -9583, -9346, -11708, -6579, -2929, 4844, -8191, -4919, 2210, 5588, -7566, -7010, -1942, 8966, -5311, -4402, -1156, 5830, -6014, -4697, -3644, 10794, -4847, -2749, -893, 5305, -2776, -330, 2232, 2788, -2073, -533, 11969, 3280, -4991, -1701, -388, -258, -7814, -4493, -6158, -5206, -4899, -2483, -1323, -7035, -5314, -1695, 9207, 6128, -3996, -2992, -1692, -384, -6162, -4248, 5549, 4421, -7371, -6236, -4895, 1887, -8837, -6589, -8347, 49, -5604, -4328, 8594, 1552, -3275, -1973, -8461, 1643, -7245, -5368, 8871, -9247, -9462, -8140, -8553, -2749, -9339, -6049, -541, 887, -2933, 710, 6485, -2913, -2295, -2034, 1153, -6764, -2203, -1483, 9552, 848, 1403, 2171, -9867, -1601, 1399, 3287, -3550, -2893, -1983, 503, 3769, 126, -1677, -480, 12987, -5863, -2643, 826, 4532, -2076, -2021, 1284, -3512, 1247, -2845, -463, 621, -4737, -5261, -2508, -9894, -4371, 1341, 2678, -3085, -12377, -915, 133, 3961, -5299, -3955, -2805, 200, -1422, -6282, -4245, -6421, -1335, -2572, -1352, 4426, -9041, -2589, -1299, -1169, -8106, -4063, -2963, -10185, 229, -4552, -3724, -5924, 1465, -8315, -5518, 4219, -5694, -2078, 1809, 1002, -3953, 1452, 2535, 4377, 1832, -2296, -584, -3435, 3211, -1578, -2, -3886, -9795, -430, 1600, -11293, -3867, -1396, 437, 3786, 759, -1182, 74, 5587, 5795, -2079, 716, 1216, 7503, -1959, -25, 3486, 4687, -2854, -589, 11049, 11137, -1539, 377, -4887, 7071, 2045, 3199, 2514, 3622, 606, 1610, 589, 3457, -85, 1236, 7284, -3176, -153, 1972, -8081, 48, -1386, -377, 386, 1344, -3022, -2942, 4602, 1972, -5427, -4720, 5769, -2297, -6909, -6118, -2588, 380, -9948, -7305, 756, -1368, -4840, -1039, 5708, 1464, 1173, 1697, 5889, 56, -871, 1597, 6666, -13301, 1018, 2655, 1650, 1923, -529, 1387, -8480, 4886, 524, 1461, 9241, 7744, 251, 1867, -6409, -2986, -26, 1851, -3608, -4806, -1446, 172, -499, -5563, -4098, -2725, 7006, -6811, -2586, -933, -5000, 3111, 3002, 3706, 2550, -537, 661, 1368, -5345, 2359, 770, 1860, 3033, -661, 688, 1991, -7006, -4349, 788, 1837, 1619, 480, -5001, -4946, 1853, 7343, -6129, -4944, 8174, 12261, -2610, -2174, -1543, 13802, -5676, -2856, 1914, 2909, -1189, 3654, 209, -2432, 3368, 4668, 559, -6722, -885, 1375, 4219, -5044, -1256, 73, 4579, -13003, -2172, -504, 5271, -1705, -1692, -1129, 10896, -9214, 2004, 3935, -5318, -871, 4280, 5324, -145, 4418, 1846, 2748, -8038, -777, -1158, 747, -2105, -2879, 1781, 2872, -5951, -2192, 5211, 6433, -3120, 12969, 6452, 6660, 3912, -2834, 2376, 4760, 2452, 705, 3236, 5305, 2245, -2923, 423, 2448, 5917, 9158, -812, -422, 5361, -3387, -5647, -4510, -397, -4839, -1272, -72, -4426, -14307, -1167, 2155, -6421, -3171, -3050, 1300, 4835, 8406, 3454, 3417, -10222, 4550, 1673, 2608, 8940, 5050, 1136, 2069, -2630, 2050, -1547, 37, -2134, -10755, -2387, -1075, 2355, -6157, -227, 1800, 8741, -4272, 6651, 8143, -10594, 6714, 8262, 9159, 1317, -266, 3238, 5109, -8048, -637, 6970, 7584, 2593, -8670, 2232, 2954, -237, -10567, 4251, 5699, 3670, -5423, 4049, 5813, 7956, -9569, 8780, 10148, -1238, -8670, 1438, 2959, 1620, -17802, 102, 1811, 1105, -6569, 3292, 4163, -699, -6002, 4238, 5154, -6164, -3828, 2083, 5809, -5293, -2728, -880, 2585, 5299, -13141, 300, 1085, -94, -5649, 390, 1014, -172, -11544, 2973, 3974, -5842, -10577, 3250, 5456, -7639, 4152, 3435, 4443, 13480, -567, 3266, 4834, -10512, -1808, 5257, 6730, 3379, -10678, 6386, 7573, -3115, -4559, 1007, 3033, 2563, -13755, 842, 2015, 1197, -2576, 867, 2032, 3994, -2012, -64, 1285, 139, 3052, 3929, 4811, -1221, -4857, 2990, 3627, 244, 3462, 1994, 3175, 3146, -8745, 8019, 9272, -3699, -9870, 10246, 11586, -2219, -5751, 6574, 7490, 2257, -6452, -1494, 2210, -3604, -1165, 11, 3684, 9896, 8868, 4760, 5090, 3528, 1941, 6248, 6591, -7789, 7764, 7248, 7271, 4406, -6975, 4551, 5391, -4579, -7602, 7546, 7691, -5794, -3161, 6267, 6818, -4405, -7571, 6074, 6931, 10042, -9210, 8534, 8785, -1800, -4411, 3491, 4639, -5026, 7671, 1129, 2497, 3194, -212, 2384, 4446, -733, -8703, 1554, 3612, 3559, -5153, 1547, 2512, 1340, -5133, 6197, 6800, 5181, -2858, 5612, 7255, -3709, -9075, 6025, 6567, 1134, -4889, 3959, 4763, -171, -5038, 2797, 3079, -2846, 2038, -4626, -2199, 4168, -4361, 1549, 5756, 1764, -10001, 6682, 8611, 4846, 5046, 7270, 7857, 1559, -5510, 5686, 7298, -1717, -5717, 2577, 4174, 971, -4156, 6646, 6776, 9856, 534, 7258, 7627, 1144, -4646, 3313, 3859, 3671, 4244, 3201, 2746, 8839, 5348, 1368, 2359, 9148, -1213, 5181, 6350, -6625, -8920, 6466, 8510, -8150, -1420, 6924, 8269, -6052, -752, 6752, 7401, -807, -7727, 6254, 7127, 4493, -10245, 6519, 7868, -10340, 1692, 5620, 6262, 3440, 1895, 4627, 5371, 1876, 3667, 6311, 6985, -16, 5687, 1107, 4556, 1149, -5740, 1810, 5778, -8846, -4576, 5535, 6461, 4920, -8624, 8388, 9912, 1613, -8045, 7217, 8966, -9186, 755, 1907, 3589, -3466, 85, 3386, 4130, 10157, 2597, 2219, 2659, 3747, 4362, 3447, 3482, 4188, -3870, 1373, 1944, -3322, -9828, 4380, 5664, -7527, -11072, 6460, 7318, 3667, -7772, 3203, 5163, 1548, -11232, 5724, 6374, 1430, -11018, 6072, 6572, 5347, -5944, 6356, 7429, 7386, -872, 5683, 6598, -6693, 66, 7486, 7880, 5209, -1436, 6617, 7059, 1424, 605, 7714, 7531, -839, -3168, 5131, 9318, -3136, -2476, -1293, 1920, -4521, -1441, 3681, 4161, -2943, -2989, 3587, 4750, 1145, -4316, 6812, 8206, 1213, -8424, 2893, 4725, 4730, 3203, 5941, 7014, 5661, -8294, 3399, 4655, -666, -4086, 6890, 7643, -176, -5543, 4881, 6430, -2379, -7200, 2080, 4488, -7057, -8936, 1241, 2092, 6762, -7630, -54, 1407, -8230, -3043, 5527, 6221, 2156, -3536, 5388, 6618, -364, -3131, 2272, 3874, 430, -6229, 4970, 5593, -487, -9256, 5144, 5574, 273, -7816, 4598, 4655, -1254, -11371, 6402, 6114, -3005, -4809, -47, 3710, -5887, -1760, -4695, -392, -4736, -3686, -536, 2049, -5175, -3863, -2269, 521, -3846, -5257, 240, 3131, -301, -1911, -1617, 1037, -1807, -6491, 2172, 5216, -1678, -6345, 3050, 5920, 6835, -1066, 4199, 7703, -1030, -7168, 185, 3655, -5953, -2862, -3760, -289, -4793, -4534, -3889, -1144, -5455, -4815, -1350, 1575, -8779, -4169, -106, 2684, -3817, -4147, -477, 2278, -2582, -5442, -1776, 1387, 4137, -1056, -921, 2280, 8371, -3923, -1899, 598, 3823, -3914, -2565, -517, -3903, -5988, -3082, -1288, -2518, -5893, -2144, 1952, 2050, -972, -9451, -5641, -151, -1166, -8780, -7739, 1559, 641, -8641, -7612, 1412, 1924, -8623, -8104, 1645, 3247, -8479, -7910, 1297, 3265, -7992, -6981, 251, 789, -9183, -7158, -826, 25, -9254, -6403, 2742, 1451, -10751, -6846, 132, 782, -10789, -7913, 1361, 2528, -11702, -8792, 923, 336, -10557, -7201, 5167, 4401, -8994, -5961, -1289, 5184, -9318, -6296, 737, 4089, -8958, -6871, -1071, 4043, -9490, -7716, 1737, 2463, -9868, -7409, 555, 1744, -8637, -6521, -529, 1667, -7401, -5636, -198, 1879, -8205, -4495, 1278, 1625, -10941, -4447, 2445, 3402, -8226, -6468, 5321, 6038, -7508, -5012, 2988, 7624, -7010, -3985, 3105, 7968, -7373, -3371, 1171, 6512, -7652, -3053, 620, 6591, -8589, -4310, 3182, 5616, -9389, -5152, 9008, 6964, -12188, -7705, 834, 6681, -10636, -8596, -592, 6708, -12586, -10740, -2733, 4388, -10263, -6757, 3209, 1752, -11350, -6732, 2286, 85, -9358, -5447, -253, 6683, -7694, -4930, -2009, 2091, -10184, -7767, -542, 4635, -9259, -6622, -1363, 3483, -9652, -7071, -347, 1710, -7546, -5639, -1292, 530, -10043, -4402, -434, 455, -11571, -5311, 1614, 1301, -8915, -6722, 2071, 36, -8460, -4906, 1508, -588, -7594, -3303, 1772, -937, -8045, -2716, 409, -2513, -7658, -1978, 2988, 651, -8508, -3714, 4257, 979, -9785, -5654, 3747, -1591, -12188, -7314, 1285, -974, -11901, -9192, -1702, -89, -11153, -9210, 2661, 243, -10548, -7576, -1691, 31, -10865, -6994, 6626, -4053, -6790, -2810, 2034, -2239, -9432, -5981, 3432, -1989, -7167, -4852, -4632, -3327, -9192, -6737, 2629, -1697, -7592, -4499, -3136, -2782, -6650, -4283, -3211, -1666, -9253, -4007, -96, 4019, -11311, -5285, -210, 2553, -8905, -7504, -2174, 2765, -8025, -5589, 48, 5993, -6567, -3913, -1831, 6426, -6489, -2199, 1201, 2385, -4633, 524, 2496, 1181, -4917, -1152, 4078, 4792, -7482, -4103, 406, 3423, -9930, -5904, -405, 560, -9079, -6455, -1642, -1875, -8193, -5856, 6735, 4315, -8582, -7058, -6532, -1380, -7996, -6049, 3395, -2154, -6644, -3530, -460, -5463, -8184, -5089, -1008, -3077, -7457, -5499, 3333, -28, -5871, -5084, -3543, -2256, -5875, -4386, -882, -4587, -5895, -3772, -3874, -1777, -8739, -3939, 3445, 4874, -10078, -4254, -3744, 3839, -5571, -4975, -715, -96, -5179, -3167, 6976, 2932, -3528, -769, -6454, -449, -4958, -2019, -411, -505, -2455, 2209, 2217, 211, -1852, 1928, 5016, -3287, -6600, -2345, 2124, -971, -7812, -4224, -3135, 32, -7177, -4309, 2526, 293, -6318, -3878, 3384, 349, -6878, -3959, -7133, -3938, -5302, -3777, 1534, -1179, -5593, -3080, 531, 1721, -6964, -4546, -3606, -67, -6452, -3689, 5141, -5614, -3840, -2296, -1397, -3065, -5649, -4173, -709, 336, -5232, -4793, -3434, 100, -7523, -4132, 4461, -3969, -9788, -3182, -2037, -3297, -5271, -3392, 2391, 2295, -5356, -3423, 4142, 3596, -5701, -2765, -5400, -2585, -5414, -2521, -1183, -875, -4348, -242, 3771, 520, -3776, -682, -154, 464, -5624, -1984, 5323, 2970, -5670, -3057, -1611, 1845, -7316, -5311, 6291, 2482, -6943, -4979, -3802, -232, -6688, -4261, -3266, -580, -2739, -764, 1469, -914, -6064, -4673, 3891, -1763, -7011, -4095, -3446, -593, -6540, -4554, -1693, 677, -4492, -3516, 364, 2752, -7140, -5305, -1326, 2348, -9589, -7477, -3885, 1997, -10689, -6496, 3740, 801, -7844, -2011, 3173, 221, -3337, -1704, 5368, -489, -5538, -3040, 68, -3513, -7286, -4145, -2946, -1986, -5520, -3567, 17, 547, -4443, -2017, 8376, 4281, -3575, -1890, -6294, 1995, -4878, -2483, 4114, -2537, -6705, -4085, -2489, -1566, -7964, -6280, 3779, -736, -7980, -6483, -609, -1780, -6198, -4441, -1377, -997, -4788, -3700, 375, -473, -5520, -4556, 2893, -1384, -6808, -3758, -1274, -873, -6292, -3514, 25, 1456, -5999, -5377, 3784, 4313, -8279, -7331, 2868, 6185, -10350, -10391, -6486, 8335, -11582, -8982, 3978, -96, -8024, -1856, 1032, -845, -4670, -3476, 826, -3726, -6816, -4682, 42, -1921, -7437, -5558, -1253, -4067, -6104, -5133, -289, -1531, -4545, -4059, 6667, -5780, -5339, -3546, -3884, -2509, -6211, -4636, -1316, 2658, -5422, -3424, -1321, -585, -7344, -4992, 251, 126, -6087, -4673, 3436, -205, -4625, -3456, -4433, 4797, -6197, -5653, 1867, -1349, -5983, -4767, 3320, 5828, -5724, -3081, -2185, 4383, -5922, -4335, 5861, 8898, -5419, -6444, -3243, 1875, -7802, -7525, 3970, -2636, -7534, -7435, -4441, -3757, -10075, -8157, -1731, -3356, -8797, -2948, 5399, 2645, -5422, -4648, -4085, 3189, -6331, -5101, 5015, 4826, -7454, -6429, -3648, 2506, -6757, -6450, 241, -3444, -5453, -5070, 330, -3316, -3838, -3064, 10753, 1067, -3773, -2232, -8907, 1458, -4470, -2717, 2590, -1233, -5539, -3180, -4222, -1012, -5209, -3617, 220, -3489, -5869, -4719, -1255, -5791, -6131, -4259, 1958, -3677, -4358, -3100, 6612, -4502, -4779, -2442, -7852, -4713, -4367, -2096, 5643, -5304, -4877, -5092, -1806, 5516, -3618, -3555, -3551, 346, -6374, -6104, -2263, -877, -7616, -4058, -3740, -889, -7947, -2807, 5576, -7892, -5593, -4778, -3319, -5742, -6405, -5761, 5543, -4931, -7901, -7395, -4180, -2632, -6250, -5141, 2319, 2817, -2583, -2821, 6802, -572, -2968, -3460, -1498, -5255, -3678, -2752, -3458, -6221, -3670, -1974, 354, -6145, -5231, -2848, -4058, -6860, -4607, -2680, -9, -1136, -4896, -2819, 8543, 2837, -2144, -1174, -184, 1209, -2430, -1803, 3304, -4247, -959, -144, -2409, -3119, -2504, -588, 8570, -4731, -1869, -1042, -1180, -6879, -4133, -3792, -7994, -4919, -4090, -3687, -4103, -2773, -7802, -2635, 3747, 6549, -4525, -262, 6, 8083, -1794, -2397, 6196, 1650, -2550, -4086, -4828, 2353, -3350, -4753, 495, -5960, -4573, -4086, 680, -4465, -3482, -4382, 3536, -3050, -1702, -2660, -2182, -5322, -1973, -2735, 3171, -4576, -3222, -2936, -5943, -2499, -3299, -2524, 4598, 3135, -2464, -1322, -2100, 3456, -4092, -2460, 6120, -1626, -3686, -1760, -297, -3963, -1608, -897, 4923, 1009, -224, -441, -5577, 493, -2288, -1560, 2109, -4790, -2474, -1364, -2227, -8963, -1983, -1411, -186, -4345, -1756, -1767, -2291, 690, -6576, -2890, 10679, 1747, -5483, -614, -4474, -3203, -4394, -3684, 5976, 5057, -1673, -2989, -9141, -982, -2322, -4039, -649, -2214, -4705, -3156, 1952, -2552, -2380, -3163, 2228, -1431, -2235, -3417, -493, -3001, -2365, -3793, 2853, -425, -2411, -4308, -1496, 2101, -3939, -4947, 7555, -510, -3762, -2781, -4132, -3108, -4331, -2059, -971, -1789, -3530, -1497, -1494, -1247, -2865, -2408, 4659, -6842, -1206, -934, -1590, -6582, -2908, -1587, -384, -2415, -582, 469, 1174, -1623, -319, -123, 1503, -988, -1641, -1945, -2256, 3656, -5681, -1885, 7592, -7168, -5411, -22, -4077, -7422, -2004, -1390, 5516, -5271, -779, -531, -6902, -3782, 652, 438, -525, 38, -2237, -658, 780, -1932, 506, -14, 1448, -1962, 108, -2600, 3259, -879, -331, -3479, 1859, -2320, -1633, -4339, 1207, -2740, -4212, -3572, 1388, -3841, -3806, -2257, -3357, -6888, -1700, -326, 1125, -5082, -1883, -2323, -171, -3111, -632, -1124, 2373, -2492, -605, -456, 553, -3581, -1873, -2251, 314, -2754, -1611, -2464, 3872, -482, -928, -2352, -613, 4225, -1333, -2492, -2902, 404, -6922, -2007, 2369, -1650, -5286, -2093, -1251, -1945, -716, -3173, 5764, -4760, 2252, 444, 338, -4077, 2309, 907, -90, -3154, 353, -644, 3118, 1007, 2759, 397, -2648, -545, 2200, -665, 6015, 6105, 4249, 3371, -7976, 4252, 1775, 1624, 1100, -4459, -2443, -190, -3078, -6448, -3325, -1724, 769, -5066, -1441, -799, 5945, -1239, 2236, 1652, -2485, -2626, 1768, 1445, 217, -3034, -871, -531, 3888, -2019, -433, -1160, 81, -3436, -980, -2785, 5947, -3844, -438, -2575, -2731, -6272, -2652, -4057, -6102, -2998, -7011, -2431, -993, -108, -5717, -2482, 1392, -1137, -1930, -4087, 943, -1491, 210, -1829, 2332, -3306, 73, -1776, 167, -2505, -66, -1571, 3801, -1509, 1607, 29, -3419, -2881, 1878, 504, 7741, -3617, 2757, 3820, -8294, -5417, 1378, 3601, -2383, 308, -2773, -366, 2663, -202, -3163, -2194, -1771, -259, -3590, -2715, 2461, -2933, -91, 1327, -738, -4333, -26, 1537, 1911, -1814, -1855, 244, 2694, -2506, -1113, -40, 3087, -1073, -1821, -1822, -2025, -900, -3123, -4149, -1220, 179, -3972, -4704, -3120, 2330, -8187, -4915, -14, 3738, -4628, -3740, 2156, 5904, -4340, -5616, 1039, 7804, -3027, -5592, -57, 7305, -3541, -5911, 770, 7462, -5008, -5231, -377, 7968, -6090, -4197, 25, 6745, -6917, -4166, 818, 5353, -7031, -4214, 3049, 6213, -6123, -4996, 1174, 6728, -5448, -5858, 438, 6983, -5105, -5646, 2871, 5980, -5937, -5983, 2926, 7155, -6374, -5285, 802, 7292, -6368, -5785, -1882, 8391, -5742, -5317, 205, 7087, -6398, -5317, -997, 7221, -7070, -5586, -340, 4770, -7655, -6338, 3041, 4624, -8280, -6694, -100, 3703, -7575, -5443, -1849, 1831, -5745, -4562, 6272, 3848, -3587, -5445, 3344, 4840, -2938, -6212, -1016, 4253, -4106, -6421, 1437, 3299, -6933, -5322, -3124, 3965, -7563, -3996, -3342, 3205, -7163, -3708, 2501, 5330, -7743, -4297, 5847, 6847, -8350, -7017, 1739, 7203, -7616, -8754, -507, 6785, -6578, -7190, 5206, 5697, -6409, -6157, 4387, 4712, -6777, -5303, 2178, 5599, -6581, -5159, -3397, 7186, -6529, -5512, 433, 5435, -7298, -5952, -2137, 6014, -8304, -7073, -2292, 7678, -7168, -6969, 4365, 6572, -8116, -6509, -454, 1811, -9783, -5428, -2801, 272, -6082, -3343, 6714, 911, -2706, -3546, 2466, 31, -1801, -4088, -2158, -307, -3865, -4071, 192, -3179, -6809, -2844, -6140, -4478, -6062, -1606, -4573, -3318, -5514, -2132, 1937, -131, -8346, -4782, 2763, 215, -8425, -6455, 1636, 877, -6962, -7475, -2203, 2073, -5674, -5428, 5668, 3236, -5586, -5051, 3466, 860, -5758, -3984, 2502, 1171, -6122, -4189, -2129, -95, -7215, -5403, 2065, -30, -6706, -5922, -2432, -102, -7582, -7415, -1241, 367, -6949, -7368, 602, 500, -7915, -5884, -1919, 222, -9792, -4496, 1364, 4725, -6446, -3343, 2925, 6195, -3273, -3955, 752, 5124, -818, -3771, -1311, 7766, -3099, -4465, -1770, 7424, -6216, -3896, -5763, 3461, -4876, -2603, -7774, 2505, -4556, -2844, 3526, 4079, -8625, -5554, -250, 5599, -7365, -6289, 220, 2714, -5011, -5694, -263, 2606, -5108, -4631, 4114, 7083, -5260, -5012, -2378, 5005, -5554, -4987, 341, -1709, -5968, -4412, -416, -4023, -6920, -4918, 1827, -2889, -6605, -5542, 605, -1023, -7279, -6655, -4488, -787, -7123, -7072, 853, -3112, -7510, -5149, -605, -1799, -10298, -4681, 6276, 3037, -8454, -5033, -2099, 4410, -5817, -6011, 1083, 4123, -2390, -4809, 3223, 5003, -5855, -7235, -5355, 1178, -8042, -6590, -5786, -9, -4239, -4014, -6735, -180, -3141, -2874, 3242, 736, -7940, -5317, -721, 1407, -7277, -5712, -2461, 1286, -4354, -4300, 4452, 1672, -5905, -4239, 3200, 336, -6809, -5698, -4819, -81, -5581, -4947, -1494, 1254, -3923, -4889, 1808, 4658, -4606, -5521, -5074, 1882, -4769, -5068, 1698, -3250, -6006, -5654, -1950, -91, -6359, -5967, -288, 1352, -6890, -5030, -254, 666, -9413, -4946, 6375, -4202, -8707, -4311, -2099, -1543, -7170, -5456, 4251, 2598, -4132, -5474, 1207, 2398, -7168, -7850, -6989, -1951, -8266, -7087, -3873, -3847, -4190, -3949, -160, -919, -3709, -3844, -136, -994, -6881, -5243, 1978, 220, -6401, -5585, -3439, 1751, -4867, -4422, 5140, 972, -7341, -5279, -479, -2552, -7044, -5435, -4755, -5508, -4179, -4000, 3789, -1297, -3332, -3945, 6004, 1042, -4466, -5328, -5560, 3270, -4172, -5010, -3095, 2892, -2556, -3301, 1695, 4854, -3787, -3975, -2701, 6108, -6461, -4965, -1597, 4905, -8919, -5222, 6640, -1730, -7032, -2604, -346, -1825, -6919, -3558, 5940, -308, -6856, -5677, -728, -983, -8904, -7783, -7061, -1564, -7503, -6429, 1181, 759, -3914, -4347, 7291, 5770, -5474, -6329, -4442, 3927, -6782, -7183, -860, -1970, -5637, -5973, -3474, -1373, -5153, -4902, 4756, -469, -6847, -5994, -2241, -1683, -6819, -5445, -4381, -90, -3481, -3979, 5096, -159, -5112, -3862, 4193, -339, -5268, -5053, -3822, -1495, -5524, -5322, -366, 1221, -5301, -5170, 1402, 2839, -6724, -5679, 584, 6675, -9639, -7553, -5619, 7188, -9721, -7436, 7067, -164, -6850, -2835, -657, 635, -7480, -4598, 2548, -747, -7297, -5436, -1363, -3751, -7479, -5610, -4494, -1400, -5375, -4467, 4512, 2052, -3231, -4234, 7432, -772, -6093, -6880, -448, 434, -7969, -7702, -3906, 5770, -5707, -4885, -2410, -623, -5797, -4639, 2314, 43, -5691, -4907, 55, -262, -5798, -4938, -3792, 2392, -5370, -5590, 4118, 3492, -6021, -4673, 5865, 8801, -5862, -4435, -5821, 8207, -6404, -5054, 3110, 6875, -7052, -6725, -3476, 9495, -7115, -6932, -972, 2116, -10171, -8014, -2900, 1536, -11246, -7709, 6537, -3746, -7587, -3720, 3735, -681, -7951, -6125, -1683, 815, -7021, -6062, 2108, 2203, -6889, -6351, -4576, 1783, -4946, -5152, 3583, 225, -4034, -5281, 4728, -1546, -4631, -5422, 8961, 374, -7883, -7279, -3827, -456, -9425, -7445, -9162, -428, -6024, -5142, -148, -3539, -5957, -5424, 743, -3681, -6022, -4801, 155, -1773, -5783, -5691, 3963, -1142, -6806, -5863, 6466, -1678, -7584, -6014, -6522, -146, -7851, -6905, 7698, 3937, -7292, -7886, -1914, 7455, -8408, -9115, -10017, 6549, -8512, -6931, -3473, 1967, -10521, -6537, 4745, -269, -7793, -4380, 1941, -4916, -8325, -7377, -2212, -4579, -6236, -6781, 4078, -2612, -6703, -7296, -1422, -916, -6164, -7127, 1760, 489, -4843, -6422, 2909, -307, -5825, -6286, 5585, -5191, -7667, -7222, -2425, -6522, -8019, -6680, -8215, -3881, -5162, -4894, 297, -3219, -4074, -3379, 2514, 1195, -5879, -3285, 5566, 4014, -4729, -4757, 311, 3842, -5189, -4914, 3693, -3357, -5459, -5029, -4588, -6962, -6817, -5753, 9719, -5052, -6664, -7053, -644, -4401, -8271, -9251, -11143, -4876, -9319, -7327, -3048, -394, -10524, -5897, 4994, 5230, -7818, -4091, -2859, 6417, -6449, -5087, 1188, 1779, -5195, -5595, -64, -175, -5640, -5842, -950, -3862, -5616, -6144, 884, -4313, -4562, -6327, 2269, -3021, -4616, -6552, 2723, -5204, -4648, -6085, 129, -4876, -5039, -6023, -4698, -2156, -4396, -5874, 5025, 6336, -2929, -4332, -797, 4955, -5470, -4253, 5567, -2599, -5656, -4716, -827, -1579, -4962, -4603, 3465, 1661, -4411, -5500, -7430, 1239, -5079, -5300, 2932, -4448, -5108, -5411, -1597, -8184, -5026, -5099, -3004, -2787, -6606, -5195, -1343, 1532, -9458, -5564, 7989, 1383, -8731, -5551, -3679, 2582, -8279, -6388, 1976, 6388, -5406, -5980, -6111, 5853, -4952, -5291, -3296, 1619, -3916, -4290, -292, -539, -2523, -5005, 1804, 493, -3699, -6526, 1216, -226, -3682, -6851, 1160, 681, -2348, -6255, 1595, 2732, -2643, -5893, 5792, 496, -4136, -6077, -3737, 1382, -6286, -5970, -1153, -3362, -4509, -4087, -193, -7951, -3461, -3315, 2647, -7898, -3885, -5225, -5823, -5564, -5506, -5761, -62, -2288, -3308, -4919, -2292, -2252, -2381, -4023, 3616, 2684, -4698, -4769, -1574, 3461, -8136, -5252, 7892, -7162, -8548, -5026, 238, -6067, -8645, -6213, 3056, -1451, -7308, -7612, -7639, -439, -6192, -6175, -4512, -26, -2885, -4232, -2564, 317, -918, -5721, 2464, -2962, -3318, -6677, 3021, 1370, -4329, -7347, -685, -1790, -4137, -5629, 1781, -2283, -5418, -6190, 2823, -5670, -5099, -5658, -4031, -7663, -5446, -4942, 37, -146, -3325, -4287, -1031, 13, -2765, -4013, 488, -3008, -3907, -5307, -3479, -3713, -4607, -6616, 2759, -2946, -3052, -6166, 2461, 31, -1480, -5817, 3312, 4834, -4649, -5699, -4698, 4252, -8224, -5242, 3976, -2736, -7060, -3985, 4766, -5279, -6409, -3718, 4558, -7742, -6500, -4647, -4674, -7758, -5626, -4039, 589, -4079, -3118, -4262, -1521, -2577, -1759, -5877, 3543, -2296, -3682, -5798, 5095, 3452, -5311, -5582, -6961, 4091, -4244, -3200, -1196, -3842, -5174, -3660, -3882, -7280, -4602, -3621, 3054, -6493, -4248, -2968, 3469, -3421, -3991, -4374, -3725, -1967, -3208, -4888, -1624, -2873, -3256, -5438, -817, -4411, -4251, -6638, 3380, -6089, -3506, -6191, 5131, -5088, -3357, -5995, 1648, -4286, -6556, -6182, -4889, -1492, -8302, -5035, 1129, -482, -4884, -3189, 3174, -1290, -4240, -2764, 2525, -4179, -4373, -2742, -841, -4718, -4449, -3368, 2052, -3088, -3576, -4076, 1277, -2536, -3275, -5062, 4493, -3185, -4472, -4331, 2628, -5820, -6437, -3850, -5052, -6895, -6980, -3273, -6348, -4727, -5142, -2330, -1372, -2850, -4023, -2715, 1065, -3540, -4189, -2859, 2858, -6146, -4073, -3413, -5099, -5392, -3873, -3706, -266, -2097, -4135, -4483, 1226, -1631, -4333, -5369, 3461, -2617, -4204, -5114, 1879, -3989, -4349, -4426, 1124, -2223, -6077, -3801, -1606, 929, -6998, -3612};

// Comparator function for sorting floats.
int compare_floats(const void *a, const void *b) {
  const float *da = (const float *) a;
  const float *db = (const float *) b;

  return (*da > *db) - (*da < *db);
}

// Function for computing the deviation from the expected floating point
// result and returning the largest such deviation found.

float compute_error(const Q15_T* const pred, const float* const label,
                    float* const errors, SCALE_T scl) {
  float agg_diff = 0.0;

  for (unsigned i = 0; i < OUTPUT_SIZE; i++) {
    float f_pred = ((float)pred[i]) / pow(2, scl);
    float single_diff = fabs(f_pred - label[i]);
    agg_diff = single_diff > agg_diff ? single_diff : agg_diff;
    errors[i] = single_diff;
  }

  return agg_diff;
}

// Function for computing the 95th percentile deviation among all the outputs.
float aggregate_error(float* errors, unsigned len) {
  qsort(errors, len, sizeof(float), compare_floats);
  unsigned index = (unsigned) round(fmax((0.95 * len - 1), 0));
  return errors[index];
}

/** Run this test using the following command:
 * $: ./test_quantized_face_detection_fast <num_patches> <input.npy>
 *    <output.npy> <expected_output.npy> <log.txt>
 *  By default, all tests run without using bit-shifting operations.
 */
int main(int argc, char **argv) {
  unsigned patches;
  SCALE_T XScale = -1, YScale = 12;

  FILE *xFile, *yFile, *floatResFile, *outputLog;

  if (argc != 6) {
    printf("Improper Number of Arguments Provided!\n");
    return -1;
  } else {
    patches = atoi(argv[1]);
    xFile = fopen(argv[2], "rb");
    yFile = fopen(argv[3], "wb");
    floatResFile = fopen(argv[4], "rb");
    outputLog = fopen(argv[5], "w");
  }

  if (xFile == NULL) {
    printf("An error occured while opening the input file.\n");
    return -1;
  }
  if (yFile == NULL) {
    printf("An error occured while opening the predicted output file.\n");
    return -1;
  }
  if (floatResFile == NULL) {
    printf("An error occured while opening the expected output file.\n");
    return -1;
  }
  if (outputLog == NULL) {
    printf("An error occured while opening the output log file.\n");
    return -1;
  }

  char line[9];
  fgets(line, 9, xFile);
  fgets(line, 9, floatResFile);

  int16_t headerSize;
  fread(&headerSize, sizeof(int16_t), 1, xFile);
  char* headerLine = malloc((headerSize + 1) * sizeof(*headerLine));
  fgets(headerLine, headerSize + 1, xFile);

  int16_t floatHeaderSize;
  fread(&floatHeaderSize, sizeof(int16_t), 1, floatResFile);
  char* floatHeaderLine = malloc((floatHeaderSize + 1) * sizeof(*floatHeaderLine));
  fgets(floatHeaderLine, floatHeaderSize + 1, floatResFile);
  free(floatHeaderLine);
  free(headerLine);

  char numpyHeader1[] = "{'descr': '<f4', 'fortran_order': False, 'shape': (";
  unsigned len = snprintf(NULL, 0, "%d", patches);
  char* numpyHeader2 = malloc((len + 1) * sizeof(char));
  snprintf(numpyHeader2, len + 1, "%d", patches);
  char numpyHeader3[] = ", 1, 5400), }";

  size_t headerLength = strlen(numpyHeader1) + strlen(numpyHeader2) +
                        strlen(numpyHeader3);
  int count = 1;
  for (size_t i = headerLength + 10; i % 64 != 63; i++) {
    count++;
  }

  char numpyHeader4[count + 1];
  numpyHeader4[count] = '\0';
  numpyHeader4[count - 1] = (char)(10);
  for (int i = count - 2; i >= 0; i--) {
    numpyHeader4[i] = ' ';
  }

  headerLength += strlen(numpyHeader4);
  char a = headerLength / 256 , b = headerLength % 256;

  char numpyMagix = 147;
  char numpyVersionMajor = 1, numpyVersionMinor = 0;

  fputc(numpyMagix, yFile);
  fputs("NUMPY", yFile);
  fputc(numpyVersionMajor, yFile);
  fputc(numpyVersionMinor, yFile);
  fputc(b, yFile);
  fputc(a, yFile);
  fputs(numpyHeader1, yFile);
  fputs(numpyHeader2, yFile);
  fputs(numpyHeader3, yFile);
  fputs(numpyHeader4, yFile);

  char* mem_buf = malloc(MEM_BUF_SIZE * sizeof(char));
  float* xLine = malloc(INPUT_IMG_HEIGHT * INPUT_IMG_WIDTH * sizeof(float));
  float* yLine = malloc(OUTPUT_SIZE * sizeof(float));
  float* allErrors = malloc(patches * OUTPUT_SIZE * (sizeof(float)));

  float time_spent = 0.0;
  Q7_T* mem_buf_input_offset = (Q7_T *)mem_buf;
  Q15_T* mem_buf_output_offset = (Q15_T *)(mem_buf + 2 * OUTPUT_SIZE);
  for (unsigned i = 0; i < patches; i++) {
    fread(&yLine[0], sizeof(float), OUTPUT_SIZE, floatResFile);
    fread(&xLine[0], sizeof(float), INPUT_IMG_HEIGHT * INPUT_IMG_WIDTH, xFile);

    for (unsigned j = 0; j < INPUT_IMG_HEIGHT * INPUT_IMG_WIDTH; j++) {
      mem_buf_input_offset[j] = (Q7_T)(xLine[j] * pow(2, XScale));
    }

    fprintf(outputLog, "Running Quantized Face Detection Model on Patch %d\n", i + 1);
    clock_t begin = clock();
    q_face_detection_fast(mem_buf);
    clock_t end = clock();
    time_spent += (float)(end - begin) / CLOCKS_PER_SEC;
    fprintf(outputLog, "Time elapsed is %f seconds\n", time_spent);

    float max_diff = compute_error(mem_buf_output_offset, yLine,
                                   allErrors + i * OUTPUT_SIZE, YScale);
    fprintf(outputLog, "Maximum Observed Deviation: %f \n", max_diff);

    for (unsigned j = 0; j < OUTPUT_SIZE; j++) {
      float val = ((float)mem_buf_output_offset[j]) / pow(2, YScale);
      fwrite((char*)&val, sizeof(float), 1, yFile);
    }

    if (i == 0) {
      fprintf(outputLog, "Checking Fixed Point Outputs on Patch 1\n");
      for (unsigned j = 0; j < OUTPUT_SIZE; j++){
        if (mem_buf_output_offset[j] != expected[j]) {
          fprintf(outputLog, "Output: %d, Expected: %d at Index: %d\n",
                  mem_buf_output_offset[j], expected[j], j);
          fprintf(outputLog, "Quantized Face Detection Fixed Point Test Failed!\n");
        }
      }

      fprintf(outputLog, "Quantized Face Detection Fixed Point Test Passed!\n");
    }
  }

  fclose(xFile);
  fclose(yFile);
  fclose(floatResFile);

  float aggregate = aggregate_error(allErrors, patches * OUTPUT_SIZE);
  fprintf(outputLog, "Aggregated 95th Percentile Error: %f\n", aggregate);
  if (aggregate < 0.5916) {
    fprintf(outputLog, "Quantized Face Detection Numerical Test Passed!\n");
  } else {
    fprintf(outputLog, "Quantized Face Detection Numerical Test Failed!\n");
    return -1;
  }

  free(mem_buf);
  free(xLine);
  free(yLine);
  free(allErrors);

  return 0;
}
